# Подготовка данных для анализа успеваемости
**Цель**: получить модель данных, по которым можно строить дальнейший анализ.

**Задачи**:
- убрать коррелирующие друг с другом переменные (кроме корреляции с переменной *score*),
- проанализировать значения переменных и по возможности заполнить пропуски,
- проанализировать номинативные переменные на предмет корреляции со значением *score*,
- оставить в dataset только те переменные, которые имеют наибольшую корреляцию со значениями *score*.

## Ход работы
### Анализ пустых значений
В ходе анализа пустых значений оказалось, что существенная часть строк содержит
как минимум одно пустое значение. Поэтому удаление всех строк с хотя бы одним
нулевым знаением недопустимо, так как удалеятся 289 строк из 391 (~75%).

### Анализ выбросов
Только две переменные содержат выбросы относительно допустимых значений.

**Образование отца**
```
Fedu 25
 2.0     106
 3.0      96
 4.0      88
 1.0      78
 0.0       2
 40.0      1  
```

**Отношения в семье**
```
famrel 28
 4.0    182
 5.0     99
 3.0     62
 2.0     17
 1.0      7
-1.0      1
```
Выбросов немного, поэтому данные строки удалим из конечного набора данных.

**Количество неудач**

На построенном boxplot видно, что все значения, кроме 0, являются выбросами.
![failures  boxplot](failures_less.png)

Распределение по значениям.
```
0.0    293
1.0     49
2.0     16
3.0     15
```
С одной стороны видно распределение в пользу одного значения, с другой стороны
количество значений, отличных от подавляющего большинства значительное.
Посмотрим на значение коэффициента корелляции переменных *score* и *failures*.
```
koef = -0.329295
```
Это значит, что данная переменная является существенной в данной моделе,
поэтому удалять её нельзя.


### Анализ переменных
В описании переменных ничего не сказано про переменную "*studytime, granular*".

Сравним её с переменной *studytime*.

**studytime, granular**
```
-6.0     194
-3.0     102
-9.0      63
-12.0     27
```
**studytime**
```
2.0    194
1.0    102
3.0     63
4.0     27
```
Без дополнительного анализа видна линейная корреляция, поэтому переменную
*studytime, granular* удалим из итогового набора данных.

### Преобразование переменных
Переменные *schoolsup*, *famsup*, *paid*, *activities*, *nursery*, *higher*,
 *internet*, *romantic, *address*, *Pstatus*, *famsize* по своей природе
 содержат значения "да/нет". Поэтому заменим строковые значения на 0 и 1.

Получим коэффициенты корреляции со *score* для всех числовых значений.

| Переменная   | Коэффициент корреляции  |
|--------------|:-----------------------:|
|age	         |        -0.134469        |
|address	     |        -0.146215        |
|famsize	     |        -0.090389        |
|Pstatus	     |         0.069980        |
|Medu	         |         0.202787        |
|Fedu	         |         0.111074        |
|traveltime	   |        -0.076730        |
|studytime   	 |         0.112813        |
|failures	     |        -0.335283        |
|schoolsup	   |        -0.103062        |
|famsup	       |         0.000180        |
|paid	         |         0.071675        |
|activities	   |        -0.017322        |
|nursery	     |         0.065341        |
|higher	       |         0.136712        |
|internet	     |         0.013306        |
|romantic	     |        -0.140413        |
|famrel	       |         0.071314        |
|freetime	     |         0.026136        |
|goout	       |        -0.155077        |
|health	       |        -0.042960        |
|absences	     |         0.078819        |

Выберем только те переменные, коэффициент корреляции с которыми больше 10%.

Переменные: *age*, *address*, *Medu*, *Fedu*, *studytime*, *failures*,
*schoolsup*, *higher*, *romantic*, *goout*.

### Заполнение null и NaN значений
Рассмотрим два варианта замены: на медиану и на новое значение.

При замене на медиану имеем следующие коэффициенты корелляции.

| Переменная   | Коэффициент корреляции  |
|--------------|:-----------------------:|
|    age	     |        -0.134469        |
|  address  	 |        -0.147993        |
|   Medu       |	       0.202787        |
|   Fedu       |	       0.111074        |
| studytime    |	       0.112813        |
|  failures	   |        -0.335283        |
| schoolsup	   |        -0.103062        |
|  higher	     |         0.135818        |
|  romantic	   |        -0.139301        |
|   goout	     |        -0.155077        |

При замене на значение -1

| Переменная   | Коэффициент корреляции  |
|--------------|:-----------------------:|
|     age	     |        -0.134469        |
|   address	   |        -0.148583        |
|     Medu	   |         0.202787        |
|  studytime	 |         0.112813        |
|   failures	 |        -0.315641        |
|  schoolsup	 |        -0.103062        |
|   romantic	 |        -0.122873        |
|    goout	   |        -0.155077        |

### Анализ номитативных переменных
*null* и *NaN* значения также можно заменить двумя способами:
на *other* или на *None*

После анализа *boxplot* для номинативных переменных видно, что только для
переменной *Mjob* имеется корреляция.
![Mjob other boxplot](/Mjob_other.PNG)
![Mjob None boxplot](/Mjob_none.PNG)

### Выводы и формирование итогового *dataset*
В итоговый dataset включим переменные, которые имеют коэффициент корреляции
с переменной score больше 10% при заполнении пустых значений как медианным
значением, так и новым. При этом в итоговом датасете пустые значения заполним
занчением -1, потому что такой вариант позволит при необходимости выделить
неопределенные значения.

Переменные: *age*, *address*, *Medu*, *studytime*, *failures*, *schoolsup*,
*romantic*, *goout*.

Также в итоговый *dataset* включим переменную *Mjob*. Где пропуски также
заполним новым значением - *None*
